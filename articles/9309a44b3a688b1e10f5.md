---
title: "Nuxt.jsã¨Railsã§ã‚³ãƒ¡ãƒ³ãƒˆãŒå¤šã„é †ã«æŠ•ç¨¿ã‚’è¡¨ç¤ºã—ã€ã‚³ãƒ¡ãƒ³ãƒˆæ•°ã‚‚è¡¨ç¤ºã™ã‚‹"
emoji: "ğŸ”¥"
type: "tech"
topics: ["åˆå¿ƒè€…"]
published: true
---

ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªä½œæˆä¸­ã«ã€Œäººæ°—é †ã«æŠ•ç¨¿ã‚’ã„ãã¤ã‹è¡¨ç¤ºã•ã›ãŸã„ãªã€œã€ã¨æ€ã„ã€æŠ•ç¨¿ã«ã¤ã„ã¦ã„ã‚‹ã‚³ãƒ¡ãƒ³ãƒˆãŒå¤šã„é †ã«æŠ•ç¨¿ã‚’è¡¨ç¤ºã•ã›ã€ãã‚Œãã‚Œã«ã¤ã„ã¦ã„ã‚‹ã‚³ãƒ¡ãƒ³ãƒˆã®æ•°ã‚’è¡¨ç¤ºã•ã›ãŸã€‚å¿˜ã‚Œãªã„ã†ã¡ã«ãƒ¡ãƒ¢ã—ã¦ãŠãã€‚
postsãƒ†ãƒ¼ãƒ–ãƒ«ã¨commentsãƒ†ãƒ¼ãƒ–ãƒ«ã¯ç´ã¥ã„ã¦ã„ã‚‹ã€‚
ã¡ãªã¿ã«Nuxt.jsã¨Railsé–“ã¯axiosã‚’ä½¿ã£ã¦é€šä¿¡ã—ã¦ã„ã‚‹ã€‚
# ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½œã‚‹
æŠ•ç¨¿ã«ç´ã¥ã„ã¦ã„ã‚‹ã‚³ãƒ¡ãƒ³ãƒˆã®æ•°ã‚’countãƒ¡ã‚½ãƒƒãƒ‰ã§ç®—å‡ºã—ã€ãã®æ•°ãŒå¤šã„é †ã«ã‚½ãƒ¼ãƒˆã•ã›ã‚‹ã€‚
ä»Šå›ã¯limit(5)ã§ä¸Šä½ï¼•ã¤ã®ã‚¹ãƒãƒƒãƒˆã‚’æŠ½å‡ºã—ãŸã€‚
```ruby:posts_controller.rb
  def ranking
    @all_ranks = Post.find(Comment.group(:post_id).order('count(post_id) desc').
    limit(5).pluck(:post_id)) 
  end
```
# ã‚³ãƒ¡ãƒ³ãƒˆæ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ä½œæˆ
```ruby:post.rb
  def comment_count
    comments.count
  end
```
# jsonå½¢å¼ã§é€ã‚‹
ãƒ¡ã‚½ãƒƒãƒ‰ã‚’"@all_ranks"ã¨ä¸€ç·’ã«jsonã§é€ã‚‹
é€ã‚‹ã¨ãã¯"methodsï¼š"ã¨ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®å‰ã«".to_json"ã‚’ã¤ã‘ã‚‹
```ruby:posts_controller.rb
  def ranking
    @all_ranks = Post.find(Comment.group(:post_id).order('count(post_id) desc').
    limit(5).pluck(:post_id)) 
   # è¿½åŠ 
    render json: @all_ranks.to_json(methods: [:comment_count])
  end
```
jsonãƒ‡ãƒ¼ã‚¿ã®ãƒãƒƒã‚·ãƒ¥ã®ä¸­ã«"comment_count":"ã‚³ãƒ¡ãƒ³ãƒˆæ•°"ã¨è¡¨ç¤ºã•ã‚Œã¦ã„ã‚Œã°OK
# Nuxtå´ã§è¡¨ç¤ºã•ã›ã‚‹
axiosã§getã—dataã®postã«æ ¼ç´ï¼ˆçœç•¥)
ã‚ã¨ã¯è¡¨ç¤ºã•ã›ã‚‹ã ã‘
```vue:index.vue
<template>
 <div>{{ post.comment_count }}</div>
</template>
```